<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="653px" preserveAspectRatio="none" style="width:908px;height:653px;background:#FFFFFF;" version="1.1" viewBox="0 0 908 653" width="908px" zoomAndPan="magnify"><defs/><g><!--MD5=[d841c4c2f84d4e18d352f800547f43fc]
cluster platform--><g id="cluster_platform"><path d="M174.5,514 L247.5,514 A3.75,3.75 0 0 1 250,516.5 L257,536.2969 L898.5,536.2969 A2.5,2.5 0 0 1 901,538.7969 L901,643.5 A2.5,2.5 0 0 1 898.5,646 L174.5,646 A2.5,2.5 0 0 1 172,643.5 L172,516.5 A2.5,2.5 0 0 1 174.5,514 " style="stroke:#000000;stroke-width:1.5;fill:none;"/><line style="stroke:#000000;stroke-width:1.5;fill:none;" x1="172" x2="257" y1="536.2969" y2="536.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="72" x="176" y="528.9951">platform</text></g><!--MD5=[336f72aa230bcf97bf803b8ae8a7471f]
cluster edk2--><g id="cluster_edk2"><path d="M8.5,6 L47.5,6 A3.75,3.75 0 0 1 50,8.5 L57,28.2969 L549.5,28.2969 A2.5,2.5 0 0 1 552,30.7969 L552,487.5 A2.5,2.5 0 0 1 549.5,490 L8.5,490 A2.5,2.5 0 0 1 6,487.5 L6,8.5 A2.5,2.5 0 0 1 8.5,6 " style="stroke:#000000;stroke-width:1.5;fill:none;"/><line style="stroke:#000000;stroke-width:1.5;fill:none;" x1="6" x2="57" y1="28.2969" y2="28.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="38" x="10" y="20.9951">edk2</text></g><!--MD5=[859ab30549852151da41ea1c49d0d2f6]
class RpmcLib--><g id="elem_RpmcLib"><rect codeLine="2" fill="#F1F1F1" height="80.5938" id="RpmcLib" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="326" x="559" y="549"/><ellipse cx="685.75" cy="565" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M688.0938,560.6719 C687.1563,560.2344 686.5625,560.0938 685.6875,560.0938 C683.0625,560.0938 681.0625,562.1719 681.0625,564.8906 L681.0625,566.0156 C681.0625,568.5938 683.1719,570.4844 686.0625,570.4844 C687.2813,570.4844 688.4375,570.1875 689.1875,569.6406 C689.7656,569.2344 690.0938,568.7813 690.0938,568.3906 C690.0938,567.9375 689.7031,567.5469 689.2344,567.5469 C689.0156,567.5469 688.8125,567.625 688.625,567.8125 C688.1719,568.2969 688.1719,568.2969 687.9844,568.3906 C687.5625,568.6563 686.875,568.7813 686.1094,568.7813 C684.0625,568.7813 682.7656,567.6875 682.7656,565.9844 L682.7656,564.8906 C682.7656,563.1094 684.0156,561.7969 685.75,561.7969 C686.3281,561.7969 686.9375,561.9531 687.4063,562.2031 C687.8906,562.4844 688.0625,562.7031 688.1563,563.1094 C688.2188,563.5156 688.25,563.6406 688.3906,563.7656 C688.5313,563.9063 688.7656,564.0156 688.9844,564.0156 C689.25,564.0156 689.5156,563.875 689.6875,563.6563 C689.7969,563.5 689.8281,563.3125 689.8281,562.8906 L689.8281,561.4688 C689.8281,561.0313 689.8125,560.9063 689.7188,560.75 C689.5625,560.4844 689.2813,560.3438 688.9844,560.3438 C688.6875,560.3438 688.4844,560.4375 688.2656,560.75 L688.0938,560.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="706.25" y="569.8467">RpmcLib</text><line style="stroke:#181818;stroke-width:0.5;" x1="560" x2="884" y1="581" y2="581"/><line style="stroke:#181818;stroke-width:0.5;" x1="560" x2="884" y1="589" y2="589"/><ellipse cx="570" cy="600" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="300" x="579" y="605.9951">RequestMonotonicCounter (Index, *Value)</text><ellipse cx="570" cy="616.2969" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="262" x="579" y="622.292">IncrementMonotonicCounter (Index)</text></g><!--MD5=[70eb30335235e8460ed7daf1d1377d27]
class KeyServicePpi--><g id="elem_KeyServicePpi"><rect codeLine="7" fill="#F1F1F1" height="64.2969" id="KeyServicePpi" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="336" x="188" y="557.5"/><ellipse cx="300.25" cy="573.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M302.5938,569.1719 C301.6563,568.7344 301.0625,568.5938 300.1875,568.5938 C297.5625,568.5938 295.5625,570.6719 295.5625,573.3906 L295.5625,574.5156 C295.5625,577.0938 297.6719,578.9844 300.5625,578.9844 C301.7813,578.9844 302.9375,578.6875 303.6875,578.1406 C304.2656,577.7344 304.5938,577.2813 304.5938,576.8906 C304.5938,576.4375 304.2031,576.0469 303.7344,576.0469 C303.5156,576.0469 303.3125,576.125 303.125,576.3125 C302.6719,576.7969 302.6719,576.7969 302.4844,576.8906 C302.0625,577.1563 301.375,577.2813 300.6094,577.2813 C298.5625,577.2813 297.2656,576.1875 297.2656,574.4844 L297.2656,573.3906 C297.2656,571.6094 298.5156,570.2969 300.25,570.2969 C300.8281,570.2969 301.4375,570.4531 301.9063,570.7031 C302.3906,570.9844 302.5625,571.2031 302.6563,571.6094 C302.7188,572.0156 302.75,572.1406 302.8906,572.2656 C303.0313,572.4063 303.2656,572.5156 303.4844,572.5156 C303.75,572.5156 304.0156,572.375 304.1875,572.1563 C304.2969,572 304.3281,571.8125 304.3281,571.3906 L304.3281,569.9688 C304.3281,569.5313 304.3125,569.4063 304.2188,569.25 C304.0625,568.9844 303.7813,568.8438 303.4844,568.8438 C303.1875,568.8438 302.9844,568.9375 302.7656,569.25 L302.5938,569.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="320.75" y="578.3467">KeyServicePpi</text><line style="stroke:#181818;stroke-width:0.5;" x1="189" x2="523" y1="589.5" y2="589.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="189" x2="523" y1="597.5" y2="597.5"/><ellipse cx="199" cy="608.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="310" x="208" y="614.4951">GenerateKey (*Salt, SaltSize, Key, KeySize)</text></g><!--MD5=[afb8c5888421c8b8fc722aead24d95d7]
class ProtectedVariableLib--><g id="elem_ProtectedVariableLib"><rect codeLine="13" fill="#F1F1F1" height="259.8594" id="ProtectedVariableLib" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="514" x="22" y="41"/><ellipse cx="197.75" cy="57" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M200.0938,52.6719 C199.1563,52.2344 198.5625,52.0938 197.6875,52.0938 C195.0625,52.0938 193.0625,54.1719 193.0625,56.8906 L193.0625,58.0156 C193.0625,60.5938 195.1719,62.4844 198.0625,62.4844 C199.2813,62.4844 200.4375,62.1875 201.1875,61.6406 C201.7656,61.2344 202.0938,60.7813 202.0938,60.3906 C202.0938,59.9375 201.7031,59.5469 201.2344,59.5469 C201.0156,59.5469 200.8125,59.625 200.625,59.8125 C200.1719,60.2969 200.1719,60.2969 199.9844,60.3906 C199.5625,60.6563 198.875,60.7813 198.1094,60.7813 C196.0625,60.7813 194.7656,59.6875 194.7656,57.9844 L194.7656,56.8906 C194.7656,55.1094 196.0156,53.7969 197.75,53.7969 C198.3281,53.7969 198.9375,53.9531 199.4063,54.2031 C199.8906,54.4844 200.0625,54.7031 200.1563,55.1094 C200.2188,55.5156 200.25,55.6406 200.3906,55.7656 C200.5313,55.9063 200.7656,56.0156 200.9844,56.0156 C201.25,56.0156 201.5156,55.875 201.6875,55.6563 C201.7969,55.5 201.8281,55.3125 201.8281,54.8906 L201.8281,53.4688 C201.8281,53.0313 201.8125,52.9063 201.7188,52.75 C201.5625,52.4844 201.2813,52.3438 200.9844,52.3438 C200.6875,52.3438 200.4844,52.4375 200.2656,52.75 L200.0938,52.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="218.25" y="61.8467">ProtectedVariableLib</text><line style="stroke:#181818;stroke-width:0.5;" x1="23" x2="535" y1="73" y2="73"/><line style="stroke:#181818;stroke-width:0.5;" x1="23" x2="535" y1="81" y2="81"/><ellipse cx="33" cy="92" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="308" x="42" y="97.9951">ProtectedVariableLibInitialize (*ContextIn)</text><ellipse cx="33" cy="108.2969" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="300" x="42" y="114.292">ProtectedVariableLibGetByInfo (*VarInfo)</text><ellipse cx="33" cy="124.5938" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="488" x="42" y="130.5889">ProtectedVariableLibGetByName (*Name, *Guid, *Attr, *Size, *Data)</text><ellipse cx="33" cy="140.8906" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="425" x="42" y="146.8857">ProtectedVariableLibGetByBuffer (*Var, *Data, *Size, Auth)</text><ellipse cx="33" cy="157.1875" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="232" x="42" y="163.1826">ProtectedVariableLibWriteInit ()</text><ellipse cx="33" cy="173.4844" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="429" x="42" y="179.4795">ProtectedVariableLibUpdate (*Curr, *InDel, *New, *NewSize)</text><ellipse cx="33" cy="189.7813" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="359" x="42" y="195.7764">ProtectedVariableLibWriteFinal(*New, Size, Index)</text><ellipse cx="33" cy="206.0781" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="257" x="42" y="212.0732">ProtectedVariableLibFind (*VarInfo)</text><ellipse cx="33" cy="222.375" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="413" x="42" y="228.3701">ProtectedVariableLibFindNext (*NameSize, *Name, *Guid)</text><ellipse cx="33" cy="238.6719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="308" x="42" y="244.667">ProtectedVariableLibFindNextEx (*VarInfo)</text><ellipse cx="33" cy="254.9688" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="404" x="42" y="260.9639">ProtectedVariableLibRefresh (*Var, Size, Index, Refresh)</text><ellipse cx="33" cy="271.2656" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="444" x="42" y="277.2607">ProtectedVariableLibGetSortedList (**Buffer, *NumElements)</text><ellipse cx="33" cy="287.5625" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="291" x="42" y="293.5576">ProtectedVariableLibIsHmac (*VarName)</text></g><!--MD5=[ed35742056c958a2f5dd1c26e7feb0c9]
class EncryptionVariableLib--><g id="elem_EncryptionVariableLib"><rect codeLine="29" fill="#F1F1F1" height="113.1875" id="EncryptionVariableLib" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="236" x="22" y="361"/><ellipse cx="56.8" cy="377" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M59.1438,372.6719 C58.2063,372.2344 57.6125,372.0938 56.7375,372.0938 C54.1125,372.0938 52.1125,374.1719 52.1125,376.8906 L52.1125,378.0156 C52.1125,380.5938 54.2219,382.4844 57.1125,382.4844 C58.3313,382.4844 59.4875,382.1875 60.2375,381.6406 C60.8156,381.2344 61.1438,380.7813 61.1438,380.3906 C61.1438,379.9375 60.7531,379.5469 60.2844,379.5469 C60.0656,379.5469 59.8625,379.625 59.675,379.8125 C59.2219,380.2969 59.2219,380.2969 59.0344,380.3906 C58.6125,380.6563 57.925,380.7813 57.1594,380.7813 C55.1125,380.7813 53.8156,379.6875 53.8156,377.9844 L53.8156,376.8906 C53.8156,375.1094 55.0656,373.7969 56.8,373.7969 C57.3781,373.7969 57.9875,373.9531 58.4563,374.2031 C58.9406,374.4844 59.1125,374.7031 59.2063,375.1094 C59.2688,375.5156 59.3,375.6406 59.4406,375.7656 C59.5813,375.9063 59.8156,376.0156 60.0344,376.0156 C60.3,376.0156 60.5656,375.875 60.7375,375.6563 C60.8469,375.5 60.8781,375.3125 60.8781,374.8906 L60.8781,373.4688 C60.8781,373.0313 60.8625,372.9063 60.7688,372.75 C60.6125,372.4844 60.3313,372.3438 60.0344,372.3438 C59.7375,372.3438 59.5344,372.4375 59.3156,372.75 L59.1438,372.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160" x="75.2" y="381.8467">EncryptionVariableLib</text><line style="stroke:#181818;stroke-width:0.5;" x1="23" x2="257" y1="393" y2="393"/><line style="stroke:#181818;stroke-width:0.5;" x1="23" x2="257" y1="401" y2="401"/><ellipse cx="33" cy="412" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="189" x="42" y="417.9951">EncryptVariable (*VarInfo)</text><ellipse cx="33" cy="428.2969" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="191" x="42" y="434.292">DecryptVariable (*VarInfo)</text><ellipse cx="33" cy="444.5938" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="42" y="450.5889">GetCipherDataInfo (*VarInfo)</text><ellipse cx="33" cy="460.8906" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="208" x="42" y="466.8857">SetCipherDataInfo (*VarInfo)</text></g><!--MD5=[0686b0621f3c5f885e03994da0dee36b]
class VariableKeyLib--><g id="elem_VariableKeyLib"><rect codeLine="36" fill="#F1F1F1" height="64.2969" id="VariableKeyLib" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="225" x="293.5" y="385.5"/><ellipse cx="347.75" cy="401.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M350.0938,397.1719 C349.1563,396.7344 348.5625,396.5938 347.6875,396.5938 C345.0625,396.5938 343.0625,398.6719 343.0625,401.3906 L343.0625,402.5156 C343.0625,405.0938 345.1719,406.9844 348.0625,406.9844 C349.2813,406.9844 350.4375,406.6875 351.1875,406.1406 C351.7656,405.7344 352.0938,405.2813 352.0938,404.8906 C352.0938,404.4375 351.7031,404.0469 351.2344,404.0469 C351.0156,404.0469 350.8125,404.125 350.625,404.3125 C350.1719,404.7969 350.1719,404.7969 349.9844,404.8906 C349.5625,405.1563 348.875,405.2813 348.1094,405.2813 C346.0625,405.2813 344.7656,404.1875 344.7656,402.4844 L344.7656,401.3906 C344.7656,399.6094 346.0156,398.2969 347.75,398.2969 C348.3281,398.2969 348.9375,398.4531 349.4063,398.7031 C349.8906,398.9844 350.0625,399.2031 350.1563,399.6094 C350.2188,400.0156 350.25,400.1406 350.3906,400.2656 C350.5313,400.4063 350.7656,400.5156 350.9844,400.5156 C351.25,400.5156 351.5156,400.375 351.6875,400.1563 C351.7969,400 351.8281,399.8125 351.8281,399.3906 L351.8281,397.9688 C351.8281,397.5313 351.8125,397.4063 351.7188,397.25 C351.5625,396.9844 351.2813,396.8438 350.9844,396.8438 C350.6875,396.8438 350.4844,396.9375 350.2656,397.25 L350.0938,397.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="368.25" y="406.3467">VariableKeyLib</text><line style="stroke:#181818;stroke-width:0.5;" x1="294.5" x2="517.5" y1="417.5" y2="417.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="294.5" x2="517.5" y1="425.5" y2="425.5"/><ellipse cx="304.5" cy="436.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="313.5" y="442.4951">GetVariableKey (*Key, Size)</text></g><!--MD5=[89ea96bfe4f9721cb2a0409c9be65ae8]
link ProtectedVariableLib to EncryptionVariableLib--><g id="link_ProtectedVariableLib_EncryptionVariableLib"><path codeLine="41" d="M205.633,301.052 C194.716,320.254 183.927,339.232 174.348,356.083 " fill="none" id="ProtectedVariableLib-to-EncryptionVariableLib" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="171.679,360.777,179.6038,354.9291,174.1497,356.4301,172.6487,350.976,171.679,360.777" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[3be6c3d0ddb5abe4704b964704c3c48d]
link ProtectedVariableLib to RpmcLib--><g id="link_ProtectedVariableLib_RpmcLib"><path codeLine="42" d="M466.356,301.111 C490.568,320.271 514.417,340.497 536,361 C597.036,418.984 656.67,496.745 691.348,544.692 " fill="none" id="ProtectedVariableLib-to-RpmcLib" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="694.419,548.951,692.3999,539.3113,691.4947,544.8953,685.9108,543.9902,694.419,548.951" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2b0bd7990354023ad361749f60944e7d]
link ProtectedVariableLib to VariableKeyLib--><g id="link_ProtectedVariableLib_VariableKeyLib"><path codeLine="43" d="M346.033,301.052 C361.286,330.417 376.267,359.258 387.44,380.768 " fill="none" id="ProtectedVariableLib-to-VariableKeyLib" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="389.765,385.244,389.167,375.4133,387.4606,380.8067,382.0673,379.1003,389.765,385.244" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ad74ed884bc633acf8434e03ba738e28]
link VariableKeyLib to KeyServicePpi--><g id="link_VariableKeyLib_KeyServicePpi"><path codeLine="44" d="M396.829,449.681 C388.328,478.586 375.677,521.597 366.714,552.072 " fill="none" id="VariableKeyLib-to-KeyServicePpi" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="365.197,557.23,371.5747,549.725,366.6083,552.4333,363.9,547.4669,365.197,557.23" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[30fe46372569c0ca8b0b016460338d6d]
@startuml
package platform {
      class RpmcLib {
        +RequestMonotonicCounter (Index, *Value)
        +IncrementMonotonicCounter (Index)
      }

      class KeyServicePpi {
        +GenerateKey (*Salt, SaltSize, Key, KeySize)
      }
    }

    package edk2 {
      class ProtectedVariableLib {
        +ProtectedVariableLibInitialize (*ContextIn)
        +ProtectedVariableLibGetByInfo (*VarInfo)
        +ProtectedVariableLibGetByName (*Name, *Guid, *Attr, *Size, *Data)
        +ProtectedVariableLibGetByBuffer (*Var, *Data, *Size, Auth)
        +ProtectedVariableLibWriteInit ()
        +ProtectedVariableLibUpdate (*Curr, *InDel, *New, *NewSize)
        +ProtectedVariableLibWriteFinal(*New, Size, Index)
        +ProtectedVariableLibFind (*VarInfo)
        +ProtectedVariableLibFindNext (*NameSize, *Name, *Guid)
        +ProtectedVariableLibFindNextEx (*VarInfo)
        +ProtectedVariableLibRefresh (*Var, Size, Index, Refresh)
        +ProtectedVariableLibGetSortedList (**Buffer, *NumElements)
        +ProtectedVariableLibIsHmac (*VarName)
      }

      class EncryptionVariableLib {
        +EncryptVariable (*VarInfo)
        +DecryptVariable (*VarInfo)
        +GetCipherDataInfo (*VarInfo)
        +SetCipherDataInfo (*VarInfo)
      }

      class VariableKeyLib {
        +GetVariableKey (*Key, Size)
      }
    }

    ProtectedVariableLib - -> EncryptionVariableLib
    ProtectedVariableLib - -> RpmcLib
    ProtectedVariableLib - -> VariableKeyLib
    VariableKeyLib - -> KeyServicePpi
@enduml

PlantUML version 1.2022.4beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>